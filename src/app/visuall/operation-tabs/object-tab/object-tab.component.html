<div class="panel-group">
  <div class="panel" *ngIf="selectedClasses && selectedClasses.length > 0">
    <div
      class="panel-heading"
      data-bs-toggle="collapse"
      data-bs-target="#prop-tab"
    >
      <span class="panel-title accordion-toggle"
        ><b class="va-heading2">{{ selectedClasses }}</b></span
      >
    </div>

    <div id="prop-tab" class="collapse show text-center m-1">
      <div *ngIf="selectedItemProps.segmentData" class="segment-data-container">
        {{ selectedItemProps.segmentData.value }}
      </div>
      <div *ngIf="selectedItemProps.pos" class="combined-sequence-container">
        <span
          *ngIf="selectedItemProps.leftOfTheContainedSequence"
          class="combined-sequence-container-part"
          >{{ selectedItemProps.leftOfTheContainedSequence.value }}</span
        >
        <span
          *ngIf="selectedItemProps.containedSequence"
          class="edge-CIGAR-M-Eq-X"
          >{{ selectedItemProps.containedSequence.value }}</span
        >
        <span
          *ngIf="selectedItemProps.rightOfTheContainedSequence"
          class="combined-sequence-container-part"
          >{{ selectedItemProps.rightOfTheContainedSequence.value }}</span
        >
      </div>
      <div
        *ngIf="selectedItemProps.distance"
        class="combined-sequence-container"
      >
        <span
          *ngIf="selectedItemProps.sourceSequence"
          class="combined-sequence-container-part"
          >{{ selectedItemProps.sourceSequence.value }}</span
        >
        <span *ngIf="selectedItemProps.distance" class="edge-CIGAR-M-Eq-X"
          >..({{ selectedItemProps.distance.value }})..</span
        >
        <span
          *ngIf="selectedItemProps.targetSequence"
          class="combined-sequence-container-part"
          >{{ selectedItemProps.targetSequence.value }}</span
        >
      </div>
      <div
        *ngIf="selectedItemProps.overlapSequence"
        class="combined-sequence-container"
      >
        <span
          *ngIf="selectedItemProps.sourceSequenceWithoutOverlap"
          class="combined-sequence-container-part"
          >{{ selectedItemProps.sourceSequenceWithoutOverlap.value }}</span
        >

        <ng-container
          *ngFor="
            let overlapIdentifier of selectedItemProps.overlap
              .overlapIdentifiers;
            let i = index
          "
        >
          <span
            *ngIf="
              overlapIdentifier === 'M' ||
              overlapIdentifier === '=' ||
              overlapIdentifier === 'X'
            "
            class="edge-CIGAR-M-Eq-X"
            >{{ prepareCIGARForIndex(i) }}</span
          >
          <span *ngIf="overlapIdentifier === 'I'" class="edge-CIGAR-I">{{
            prepareCIGARForIndex(i)
          }}</span>
          <span *ngIf="overlapIdentifier === 'D'" class="edge-CIGAR-D">{{
            prepareCIGARForIndex(i)
          }}</span>
          <span *ngIf="overlapIdentifier === 'N'" class="edge-CIGAR-N">{{
            prepareCIGARForIndex(i)
          }}</span>
          <span
            *ngIf="overlapIdentifier === 'S' || overlapIdentifier === 'H'"
            class="edge-CIGAR-S-H"
            >{{ prepareCIGARForIndex(i) }}</span
          >
        </ng-container>

        <span
          *ngIf="selectedItemProps.targetSequenceWithoutOverlap"
          class="combined-sequence-container-part"
          >{{ selectedItemProps.targetSequenceWithoutOverlap.value }}</span
        >
      </div>

      <table class="table table-responsive table-borderless table-sm">
        <tbody>
          <tr *ngIf="selectedItemProps.sequenceLength">
            <td class="text-start">
              <b class="va-text">Sequence Length</b>
            </td>
            <td class="va-text text-end">
              {{ selectedItemProps.sequenceLength.value }}
            </td>
          </tr>
          <tr *ngIf="selectedItemProps.segmentName">
            <td class="text-start">
              <b class="va-text">Segment Name</b>
            </td>
            <td class="va-text text-end">
              {{ selectedItemProps.segmentName.value }}
            </td>
          </tr>
          <tr *ngIf="selectedItemProps.segmentLength">
            <td class="text-start">
              <b class="va-text">Segment Length</b>
            </td>
            <td class="va-text text-end">
              {{ selectedItemProps.segmentLength.value }}
            </td>
          </tr>
          <tr *ngIf="selectedItemProps.readCount">
            <td class="text-start">
              <b class="va-text">Read Count</b>
            </td>
            <td class="va-text text-end">
              {{ selectedItemProps.readCount.value }}
            </td>
          </tr>
          <tr *ngIf="selectedItemProps.fragmentCount">
            <td class="text-start">
              <b class="va-text">Fragment Count</b>
            </td>
            <td class="va-text text-end">
              {{ selectedItemProps.fragmentCount.value }}
            </td>
          </tr>
          <tr *ngIf="selectedItemProps.kmerCount">
            <td class="text-start">
              <b class="va-text">K-mer Count</b>
            </td>
            <td class="va-text text-end">
              {{ selectedItemProps.kmerCount.value }}
            </td>
          </tr>
          <tr *ngIf="selectedItemProps.SHA256Checksum">
            <td class="text-start">
              <b class="va-text">SHA-256 Checksum</b>
            </td>
            <td class="va-text text-end">
              {{ selectedItemProps.SHA256Checksum.value }}
            </td>
          </tr>
          <tr *ngIf="selectedItemProps.URIorLocalSystemPath">
            <td class="text-start">
              <b class="va-text">URI or Local File-system Path</b>
            </td>
            <td class="va-text text-end">
              {{ selectedItemProps.URIorLocalSystemPath.value }}
            </td>
          </tr>
          <tr *ngIf="selectedItemProps.overlap">
            <td class="text-start">
              <b class="va-text">Overlap</b>
            </td>
            <td class="va-text text-end">
              {{ selectedItemProps.overlap.value }}
            </td>
          </tr>
          <tr *ngIf="selectedItemProps.sourceOrientation">
            <td class="text-start">
              <b class="va-text">Source Orientation</b>
            </td>
            <td class="va-text text-end">
              {{ selectedItemProps.sourceOrientation.value }}
            </td>
          </tr>
          <tr *ngIf="selectedItemProps.targetOrientation">
            <td class="text-start">
              <b class="va-text">Target Orientation</b>
            </td>
            <td class="va-text text-end">
              {{ selectedItemProps.targetOrientation.value }}
            </td>
          </tr>
          <tr *ngIf="selectedItemProps.mappingQuality">
            <td class="text-start">
              <b class="va-text">Mapping Quality</b>
            </td>
            <td class="va-text text-end">
              {{ selectedItemProps.mappingQuality.value }}
            </td>
          </tr>
          <tr *ngIf="selectedItemProps.numberOfMismatchesOrGaps">
            <td class="text-start">
              <b class="va-text">Number of Mismatches/gap</b>
            </td>
            <td class="va-text text-end">
              {{ selectedItemProps.numberOfMismatchesOrGaps.value }}
            </td>
          </tr>
          <tr *ngIf="selectedItemProps.edgeIdentifier">
            <td class="text-start">
              <b class="va-text">Edge Identifier</b>
            </td>
            <td class="va-text text-end">
              {{ selectedItemProps.edgeIdentifier.value }}
            </td>
          </tr>
          <tr *ngIf="selectedItemProps.indirectShortcutConnections">
            <td class="text-start">
              <b class="va-text">Indirect Shortcut Connections</b>
            </td>
            <td class="va-text text-end">
              {{ selectedItemProps.indirectShortcutConnections.value }}
            </td>
          </tr>
          <tr *ngIf="selectedItemProps.distance">
            <td class="text-start">
              <b class="va-text">Distance</b>
            </td>
            <td class="va-text text-end">
              {{ selectedItemProps.distance.value }}
            </td>
          </tr>
          <tr *ngIf="selectedItemProps.pos">
            <td class="text-start">
              <b class="va-text">Pos</b>
            </td>
            <td class="va-text text-end">{{ selectedItemProps.pos.value }}</td>
          </tr>
        </tbody>
      </table>

      <div
        *ngIf="
          selectedItemProps.pathNames.value &&
          selectedItemProps.pathNames.value.length
        "
        class="panel"
      >
        <div
          class="subpanel-heading collapsed px-1"
          data-bs-toggle="collapse"
          data-bs-target="#paths"
        >
          <span class="panel-title accordion-toggle"
            ><span class="va-heading3">Paths</span></span
          >
        </div>
        <div id="paths" class="collapse">
          <table class="table table-responsive table-borderless table-sm">
            <div class="path-walk-title">
              <input
                class="btn btn-sm btn-dark va-text m-2 center"
                type="button"
                (click)="getPathsSelected()"
                value="Get Path"
                title="Get Path"
              />
            </div>
            <tbody>
              <ng-container
                *ngFor="
                  let item of selectedItemProps.pathNames.value;
                  let i = index
                "
              >
                <div class="path-walk-container va-text">
                  <div class="path-walk-item-begin">
                    <div
                      class="path-walk-name"
                      (mouseover)="
                        hightlightHoveredPath(
                          selectedItemProps.pathNames.value[i]
                        )
                      "
                      (mouseout)="removeHighlightHoveredPathWalk()"
                      [ngClass]="{
                        isHoveredPathWalk:
                          selectedItemProps.pathNames.value[i] ===
                          highlightedPathWalk
                      }"
                    >
                      <span
                        ><b>Path Name: </b>
                        {{
                          pathWalkNameTransform(
                            selectedItemProps.pathNames.value[i]
                          )
                        }}
                      </span>
                    </div>
                    <div>
                      <input
                        type="checkbox"
                        [(ngModel)]="selectedItemProps.pathChecked[i]"
                        (change)="setOtherPathsFalse(i)"
                        title="Select path"
                      />
                    </div>
                  </div>
                  <!-- If there is data for the path, show the path -->
                  <div *ngIf="selectedItemProps.pathSegmentNames[i]">
                    <div>
                      <div class="path-walk-text-container">
                        <span>
                          {{
                            selectedItemProps.pathSegmentNames[i]
                              .replaceAll(";", " ")
                              .replaceAll(",", " ")
                          }}
                        </span>
                      </div>
                    </div>
                    <div>
                      <span>
                        <b>Overlaps: </b>
                      </span>
                      <div class="path-walk-text-container">
                        <span>
                          {{
                            selectedItemProps.pathOverlaps[i].replaceAll(
                              ",",
                              " "
                            )
                          }}
                        </span>
                      </div>
                    </div>
                  </div>
                  <!-- Else if there is no data for the path, show a button to get the path -->
                  <div *ngIf="!selectedItemProps.pathSegmentNames[i]">
                    <div class="align-center display-flex justify-center">
                      <input
                        class="btn btn-sm btn-dark va-text m-2 center"
                        type="button"
                        (click)="
                          getPathFromDatabase(
                            selectedItemProps.pathNames.value[i]
                          )
                        "
                        value="Get Path's Properities"
                        title="Get Path's Properities"
                      />
                    </div>
                  </div>
                </div>
              </ng-container>
            </tbody>
          </table>
        </div>
      </div>

      <div
        *ngIf="
          selectedItemProps.walkSampleIdentifiers.value &&
          selectedItemProps.walkSampleIdentifiers.value.length
        "
        class="panel"
      >
        <div
          class="subpanel-heading collapsed px-1"
          data-bs-toggle="collapse"
          data-bs-target="#walks"
        >
          <span class="panel-title accordion-toggle"
            ><span class="va-heading3">Walks</span></span
          >
        </div>
        <div id="walks" class="collapse">
          <table class="table table-responsive table-borderless table-sm">
            <div class="path-walk-title">
              <input
                class="btn btn-sm btn-dark va-text m-2 center"
                type="button"
                (click)="getWalksSelected()"
                value="Get Walk"
                title="Get Walk"
              />
            </div>
            <tbody>
              <ng-container
                *ngFor="
                  let item of selectedItemProps.walkSampleIdentifiers.value;
                  let i = index
                "
              >
                <div class="path-walk-container va-text">
                  <div class="path-walk-item-begin">
                    <div
                      class="path-walk-name"
                      (mouseover)="
                        hightlightHoveredWalk(
                          selectedItemProps.walkSampleIdentifiers.value[i]
                        )
                      "
                      (mouseout)="removeHighlightHoveredPathWalk()"
                      [ngClass]="{
                        isHoveredPathWalk:
                          selectedItemProps.walkSampleIdentifiers.value[i] ===
                          highlightedPathWalk
                      }"
                    >
                      <span
                        ><b>Walk Sample Identifier: </b>
                        {{
                          pathWalkNameTransform(
                            selectedItemProps.walkSampleIdentifiers.value[i]
                          )
                        }}
                      </span>
                    </div>
                    <div>
                      <input
                        type="checkbox"
                        [(ngModel)]="selectedItemProps.walkChecked[i]"
                        (change)="setOtherWalksFalse(i)"
                        title="Select walk"
                      />
                    </div>
                  </div>
                  <!-- If there is data for the walk, show the walk -->
                  <div *ngIf="selectedItemProps.walks[i]">
                    <div>
                      <span
                        ><b>Haplotype Index: </b>
                        {{ selectedItemProps.walkHaplotypeIndexes[i] }}
                      </span>
                    </div>
                    <div>
                      <span
                        ><b>Sequence Identifier: </b>
                        {{ selectedItemProps.walkSequenceIdentifiers[i] }}
                      </span>
                    </div>
                    <div>
                      <span
                        ><b>Start Position: </b>
                        {{ selectedItemProps.walkSequenceStarts[i] }}
                      </span>
                    </div>
                    <div>
                      <span
                        ><b>End Position: </b>
                        {{ selectedItemProps.walkSequenceEnds[i] }}
                      </span>
                    </div>
                    <div>
                      <span>
                        <b>Walk </b>
                      </span>
                      <div class="path-walk-text-container">
                        <span>
                          {{
                            selectedItemProps.walks[i]
                              .replaceAll("\<", " \< ")
                              .replaceAll("\>", " \> ")
                              .substring(1)
                          }}
                        </span>
                      </div>
                    </div>
                  </div>
                  <!-- Else if there is no data for the walk, show a button to get the walk -->
                  <div *ngIf="!selectedItemProps.walks[i]">
                    <div>
                      <input
                        class="btn btn-sm btn-dark va-text m-2 center"
                        type="button"
                        (click)="
                          getWalkFromDatabase(
                            selectedItemProps.walkSampleIdentifiers.value[i]
                          )
                        "
                        value="Get Walk's Properities"
                        title="Get Walk's Properities"
                      />
                    </div>
                  </div>
                </div>
              </ng-container>
            </tbody>
          </table>
        </div>
      </div>

      <app-table-view
        *ngIf="isShowObjTable"
        [params]="multiObjTableInp"
        [tableFilled]="multiObjTableFilled"
        [clearFilter]="clearMultiObjTableFilter"
        (onFilteringChanged)="filterMultiObjTable($event)"
      >
      </app-table-view>
    </div>
  </div>

  <div class="panel">
    <div
      class="panel-heading collapsed"
      data-bs-toggle="collapse"
      data-bs-target="#stat-tab"
    >
      <span class="panel-title accordion-toggle"
        ><b class="va-heading2">Statistics</b></span
      >
    </div>
    <div id="stat-tab" class="collapse">
      <app-table-view
        *ngIf="isShowStatsTable"
        [params]="tableInput"
        [tableFilled]="tableFilled"
        (onFilteringChanged)="filterTable($event)"
      >
      </app-table-view>
    </div>
  </div>
</div>
